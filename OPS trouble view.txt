
SELECT DISTINCT EMPLID, EMPL_RCD, NAME, NAME_DISPLAY_SRCH, LAST_NAME_SRCH, SECOND_LAST_SRCH, FIRST_NAME, LAST_NAME, SECOND_LAST_NAME, NAME_AC, MIDDLE_NAME 
FROM PS_OP_EMPLMT_SRCH3 WHERE OPRID="RICEKD" AND EMPLID LIKE '99%' AND EMPL_RCD=0 ORDER BY EMPLID, EMPL_RCD


  CREATE OR REPLACE FORCE EDITIONABLE VIEW "SYSADM"."PS_OP_EMPLMT_SRCH3" ("OPRID", "ROWSECCLASS", "EMPLID", "EMPL_RCD", "NAME", "NAME_DISPLAY_SRCH", "NAME_PSFORMAT", "LAST_NAME_SRCH", "SECOND_LAST_SRCH", "FIRST_NAME", "LAST_NAME", "SECOND_LAST_NAME", "NAME_AC", "MIDDLE_NAME", "NAME_DISPLAY", "PER_ORG", "POI_TYPE", "BUSINESS_UNIT", "SETID_DEPT", "DEPTID", "SETID_LOCATION", "LOCATION", "COMPANY", "REG_REGION", "INSTITUTION", "NATIONAL_ID", "HR_STATUS", "MILITARY_SERVICE", "MIL_RANK", "MIL_WORN_RANK", "APPT_TYPE", "EMPL_STATUS", "OTHER_ID_JPN", "FUTURE_FLG", "REPORTS_TO", "SUPERVISOR_ID", "SETID_JOBCODE", "JOBCODE") AS 
  SELECT OPR.OPRID, OPR.ROWSECCLASS, SEC.EMPLID,SEC.EMPL_RCD , NM.NAME_DISPLAY , NM.NAME_DISPLAY_SRCH , NM.NAME , NM.LAST_NAME_SRCH , NM.SECOND_LAST_SRCH , NM.FIRST_NAME , NM.LAST_NAME , NM.SECOND_LAST_NAME , NM.NAME_AC , NM.MIDDLE_NAME , NM.NAME_DISPLAY , SEC.PER_ORG , SEC.POI_TYPE , SEC.BUSINESS_UNIT , SEC.SETID_DEPT , SEC.DEPTID , SEC.SETID_LOCATION , SEC.LOCATION , SEC.COMPANY , SEC.REG_REGION , SEC.INSTITUTION , SEC.NATIONAL_ID , SEC.HR_STATUS , SEC.MILITARY_SERVICE , SEC.MIL_RANK , SEC.MIL_WORN_RANK , SEC.APPT_TYPE ,SEC.EMPL_STATUS ,SEC.OTHER_ID_JPN ,SEC.FUTURE_FLG ,SEC.REPORTS_TO,SEC.SUPERVISOR_ID,SEC.SETID_JOBCODE,SEC.JOBCODE FROM PS_OP_SJT_PERSON SEC , PS_NAMES NM , PSOPRDEFN OPR WHERE NM.EMPLID = SEC.EMPLID AND NM.NAME_TYPE = 'PRI' AND NM.EFFDT = ( SELECT MAX(NM1.EFFDT) FROM PS_NAMES NM1 WHERE NM1.EMPLID = NM.EMPLID AND NM1.NAME_TYPE = 'PRI' AND NM1.EFFDT <= TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD') ) AND (EXISTS ( SELECT 'X' FROM PS_SJT_CLASS_ALL CLS , PS_SJT_OPR_CLS SOC WHERE CLS.SCRTY_SET_CD = 'OP_PEOPLE' AND CLS.SCRTY_TYPE_CD = SEC.SCRTY_TYPE_CD AND CLS.SCRTY_KEY1 = SEC.SCRTY_KEY1 AND CLS.SCRTY_KEY2 = SEC.SCRTY_KEY2 AND CLS.SCRTY_KEY3 = SEC.SCRTY_KEY3 AND CLS.TREE = 'Y' AND SOC.OPRID=OPR.OPRID AND SOC.CLASSID = CLS.CLASSID AND SOC.CLASSID = OPR.ROWSECCLASS AND SOC.SEC_RSC_FLG = '1' ) OR EXISTS ( SELECT 'X' FROM PS_SJT_CLASS_ALL CLS , PS_SJT_OPR_CLS SOC WHERE CLS.SCRTY_SET_CD = 'OP_PEOPLE' AND CLS.SCRTY_TYPE_CD = SEC.SCRTY_TYPE_CD AND CLS.SCRTY_KEY1 = SEC.SCRTY_KEY1 AND CLS.SCRTY_KEY2 = SEC.SCRTY_KEY2 AND CLS.SCRTY_KEY3 = SEC.SCRTY_KEY3 AND CLS.TREE = 'N' AND SOC.OPRID=OPR.OPRID AND SOC.CLASSID = CLS.CLASSID ) OR EXISTS ( SELECT 'X' FROM PS_SJT_CLASS_ALL CLS , PS_SJT_OPR_CLS SOC WHERE CLS.SCRTY_SET_CD = 'OP_PEOPLE' AND CLS.SCRTY_TYPE_CD = SEC.SCRTY_TYPE_CD AND CLS.SCRTY_KEY1 = SEC.SCRTY_KEY1 AND CLS.SCRTY_KEY2 = SEC.SCRTY_KEY2 AND CLS.SCRTY_KEY3 = SEC.SCRTY_KEY3 AND CLS.TREE = 'Y' AND SOC.OPRID=OPR.OPRID AND SOC.CLASSID = CLS.CLASSID AND SOC.CLASSID = OPR.ROWSECCLASS AND SOC.SEC_RSC_FLG = '3' )) AND EXISTS ( SELECT 'X' FROM PS_PER_ORG_ASGN ASGN WHERE SEC.EMPLID = ASGN.EMPLID AND SEC.EMPL_RCD = ASGN.EMPL_RCD ) UNION SELECT DISTINCT OPR.OPRID, OPR.ROWSECCLASS, SEC.EMPLID,SEC.EMPL_RCD , NM.NAME_DISPLAY , NM.NAME_DISPLAY_SRCH , NM.NAME , NM.LAST_NAME_SRCH , NM.SECOND_LAST_SRCH , NM.FIRST_NAME , NM.LAST_NAME , NM.SECOND_LAST_NAME , NM.NAME_AC , NM.MIDDLE_NAME , NM.NAME_DISPLAY , SEC.PER_ORG , SEC.POI_TYPE , SEC.BUSINESS_UNIT , SEC.SETID_DEPT , SEC.DEPTID , SEC.SETID_LOCATION , SEC.LOCATION , SEC.COMPANY , SEC.REG_REGION , SEC.INSTITUTION , SEC.NATIONAL_ID , SEC.HR_STATUS , SEC.MILITARY_SERVICE , SEC.MIL_RANK , SEC.MIL_WORN_RANK , SEC.APPT_TYPE ,SEC.EMPL_STATUS ,SEC.OTHER_ID_JPN ,SEC.FUTURE_FLG ,SEC.REPORTS_TO,SEC.SUPERVISOR_ID,SEC.SETID_JOBCODE,SEC.JOBCODE FROM PS_SJT_PERSON SEC , PS_NAMES NM , PSOPRDEFN OPR WHERE SEC.APPT_TYPE IN ('0', '3') AND NM.EMPLID = SEC.EMPLID AND NM.NAME_TYPE = 'PRI' AND NM.EFFDT = ( SELECT MAX(NM1.EFFDT) FROM PS_NAMES NM1 WHERE NM1.EMPLID = NM.EMPLID AND NM1.NAME_TYPE = 'PRI' AND NM1.EFFDT <= TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD') ) AND (EXISTS ( SELECT 'X' FROM PS_SJT_CLASS_ALL CLS , PS_SJT_OPR_CLS SOC WHERE CLS.SCRTY_SET_CD = 'PPLJOB' AND CLS.SCRTY_TYPE_CD = SEC.SCRTY_TYPE_CD AND CLS.SCRTY_KEY1 = SEC.SCRTY_KEY1 AND CLS.SCRTY_KEY2 = SEC.SCRTY_KEY2 AND CLS.SCRTY_KEY3 = SEC.SCRTY_KEY3 AND CLS.TREE = 'Y' AND SOC.OPRID=OPR.OPRID AND SOC.CLASSID = CLS.CLASSID AND SOC.CLASSID = OPR.ROWSECCLASS AND SOC.SEC_RSC_FLG = '1' ) OR EXISTS ( SELECT 'X' FROM PS_SJT_CLASS_ALL CLS , PS_SJT_OPR_CLS SOC WHERE CLS.SCRTY_SET_CD = 'PPLJOB' AND CLS.SCRTY_TYPE_CD = SEC.SCRTY_TYPE_CD AND CLS.SCRTY_KEY1 = SEC.SCRTY_KEY1 AND CLS.SCRTY_KEY2 = SEC.SCRTY_KEY2 AND CLS.SCRTY_KEY3 = SEC.SCRTY_KEY3 AND CLS.TREE = 'N' AND SOC.OPRID=OPR.OPRID AND SOC.CLASSID = CLS.CLASSID ) OR EXISTS ( SELECT 'X' FROM PS_SJT_CLASS_ALL CLS , PS_SJT_OPR_CLS SOC WHERE CLS.SCRTY_SET_CD = 'PPLJOB' AND CLS.SCRTY_TYPE_CD = SEC.SCRTY_TYPE_CD AND CLS.SCRTY_KEY1 = SEC.SCRTY_KEY1 AND CLS.SCRTY_KEY2 = SEC.SCRTY_KEY2 AND CLS.SCRTY_KEY3 = SEC.SCRTY_KEY3 AND CLS.TREE = 'Y' AND SOC.OPRID=OPR.OPRID AND SOC.CLASSID = CLS.CLASSID AND SOC.CLASSID = OPR.ROWSECCLASS AND SOC.SEC_RSC_FLG = '3' )) AND SEC.EMPL_RCD = 0 AND EXISTS ( SELECT 'X' FROM PS_OP_PERSON OPPER WHERE OPPER.EMPLID = SEC.EMPLID AND OPPER.SETID = SEC.SCRTY_KEY1) AND ( EXISTS ( SELECT 'Stub at Post' FROM PS_OP_ASSIGN_SRCH OAS2 WHERE OAS2.EMPLID = SEC.EMPLID AND OPR.OPRID = OAS2.OPRID ) OR 0 = ( SELECT COUNT (OAS2.EMPLID || 'No POST ') FROM PS_OP_ASSIGN_SRCH OAS2 WHERE SEC.EMPLID = OAS2.EMPLID GROUP BY OAS2.EMPLID ) OR EXISTS ( SELECT 'Left Post back to STUB' FROM PS_OP_ASSIGN_SRCH OAS2 WHERE SEC.EMPLID = OAS2.EMPLID AND HR_STATUS = 'I' ) );
